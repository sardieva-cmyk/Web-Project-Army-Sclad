<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Отчёт военного склада</title>
    <style>
        body {font-family: DejaVu Sans, sans-serif; margin: 40px;}
        h1 {color: #d00; text-align: center;}
        .header {text-align: center; margin-bottom: 30px;}
        table {width: 100%; border-collapse: collapse; margin-top: 20px;}
        th, td {border: 1px solid #000; padding: 8px; text-align: center;}
        th {background: #333; color: white;}
        .critical {background: #ffcccc;}
        .footer {margin-top: 50px; text-align: center; font-size: 12px;}
    </style>
</head>
<body>
    <div class="header">
        <h1>ОТЧЁТ ПО ВОЕННОМУ СКЛАДУ</h1>
        <h2>Дата: {{ date }} | Время: {{ time }}</h2>
        <h3>Докладывает: {{ request.user.get_full_name|default:request.user.username }}</h3>
    </div>

    <h2>Общая сводка</h2>
    <p>Всего единиц оружия: <strong>{{ weapons|length }}</strong></p>
    <p>Общий остаток оружия: <strong>{{ weapons|join:", " }}</strong> шт.</p>
    <p>Боеприпасы: <strong>{{ ammo.quantity }}</strong> шт.</p>

    <h2>Подробный список</h2>
    <table>
        <tr><th>Модель</th><th>Категория</th><th>Остаток</th><th>Статус</th></tr>
        {% for w in weapons %}
        <tr {% if w.quantity <= w.critical_threshold %}class="critical"{% endif %}>
            <td>{{ w.model }}</td>
            <td>{{ w.category }}</td>
            <td>{{ w.quantity }}</td>
            <td>{% if w.quantity <= w.critical_threshold %}КРИТИЧЕСКИ МАЛО!{% else %}В наличии{% endif %}</td>
        </tr>
        {% endfor %}
    </table>

    <div class="footer">
        <p>Секретно. Только для служебного пользования.</p>
    </div>
</body>
</html>